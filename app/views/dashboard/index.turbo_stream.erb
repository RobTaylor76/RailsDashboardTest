<%= turbo_stream.update "dashboard-content" do %>
  <div class="dashboard-header">
    <h2>System Overview</h2>
    <p class="dashboard-subtitle">Real-time monitoring and metrics</p>
  </div>

  <div class="dashboard-grid">
    <!-- System Status Card -->
    <div class="dashboard-card status-card">
      <div class="card-header">
        <h3>System Status</h3>
        <span class="status-indicator <%= @system_status.status %>"><%= @system_status.status.titleize %></span>
      </div>
      <div class="card-content">
        <div class="status-item">
          <span class="label">Uptime:</span>
          <span class="value" id="uptime"><%= @system_status.formatted_uptime %></span>
        </div>
        <div class="status-item">
          <span class="label">Last Updated:</span>
          <span class="value" id="last-updated"><%= @system_status.last_check.strftime("%H:%M:%S") %></span>
        </div>
        <div class="status-item">
          <span class="label">Status:</span>
          <span class="value"><%= @system_status.details&.dig('message') || 'No status message' %></span>
        </div>
      </div>
    </div>

    <!-- Performance Metrics Card -->
    <div class="dashboard-card metrics-card">
      <div class="card-header">
        <h3>Performance</h3>
      </div>
      <div class="card-content">
        <%= render 'metrics' %>
      </div>
    </div>

    <!-- Activity Feed Card -->
    <div class="dashboard-card activity-card">
      <div class="card-header">
        <h3>Recent Activity</h3>
      </div>
      <div class="card-content">
        <div class="activity-list" id="activity-feed">
          <% @recent_activities.each do |activity| %>
            <div class="activity-item <%= activity.css_class %>">
              <span class="activity-time"><%= activity.formatted_time %></span>
              <span class="activity-text"><%= activity.message %></span>
            </div>
          <% end %>
          <% if @recent_activities.empty? %>
            <div class="activity-item">
              <span class="activity-time"><%= Time.current.strftime("%H:%M") %></span>
              <span class="activity-text">No recent activity</span>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Quick Actions Card -->
    <div class="dashboard-card actions-card">
      <div class="card-header">
        <h3>Quick Actions</h3>
      </div>
      <div class="card-content">
        <button class="action-btn" id="refresh-btn">Refresh Data</button>
        <button class="action-btn" id="export-btn">Export Report</button>
        <button class="action-btn" id="settings-btn">Settings</button>
      </div>
    </div>
  </div>

  <div class="dashboard-footer-info">
    <p>Dashboard updates automatically every 30 seconds</p>
    <p>Last data refresh: <%= Time.current.strftime("%H:%M:%S") %></p>
  </div>
<% end %> 